---
title: "ThreeME Standard results"
subtitle: "Scénario: `r params$scenario_name`"
author: "ThreeME team"
date: "`r format(Sys.Date(), '%d %B %y')`"
output: slidy_presentation
params:
  startyear: 2020
  endyear: 2050
  scenario_name: oilprice_fra
  classification: c28_s32
  template_default: ofce
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  results = "hide"
)
```


```{r Plots default options}


startyear <- params$startyear
endyear <- params$endyear
scenario_name <- params$scenario_name
classification <- params$classification
template_default <- params$template_default

```




```{r Required packages, message=FALSE, warning=FALSE}

source("src/functions.R")
data_full<-readRDS(file = paste0("databases/",scenario_name,"_",classification,".rds"))
### loading the sector and commodity aggregated database 
data_sector <- readRDS(file = paste0("databases/",scenario_name,"_",classification,"_commodities_sectors.rds"))


source("bridges/bridge_c28_s32.R")
source("bridges/codenames_c28_s32.R")
```

---

```{r Table macro, results ='asis'}

table <- ermeeth::table.output(data = data_sector, scenario = scenario_name, 
             full.table = FALSE, export.doc = FALSE, langue = "en",
             title = 'Macroeconomic main results')

table

```

---

# Contribution to growth (in deviation)
```{r contrib Graphs, fig.height = 6, fig.width=10}
GDP_comp <- c( "CH","X","M", "I", "G","DS")
GDP_comp_label <- c( "Households consumption","Exports","Imports", "Investment", "Public spending","Stock variation")

data_plot <-  contrib(data_full,"GDP", GDP_comp, scenar = c("baseline",scenario_name))

contrib.plot(data_plot, series = GDP_comp,label_series = GDP_comp_label,
             startyear = 2020, titleplot = "Contributions to GDP gowth (in difference from baseline)", line_tot = TRUE)

```
---

# Contribution to growth (in yearly growth rate)
```{r Graph Macro Growth contrib, fig.height = 6, fig.width=10}
label_macro <- c("Gross domestic product", "Households consumption", "Investment", "Public spending")
data_plot <-  contrib(data_full,"GDP", GDP_comp, scenar = c("baseline", "oilprice_fra"), indicator = "gr.diff")

contrib.plot(data_plot, series = GDP_comp, 
             label_series = GDP_comp_label,
             line_tot = TRUE,
             startyear = 2020,
             titleplot = "Contributions to GDP growth rate (in pp)")
```
---

# Growth rate
```{r Graph Macro Growth rate, fig.height = 6, fig.width=10}
A <- simpleplot(data_full,c("GDP", "CH", "I", "G"), label_macro, startyear, endyear, "gr", titleplot = "GDP and its components (growth rates)")

B <- simpleplot(data_full,c("X", "M"), c("Exports", "Imports"), startyear, endyear, "gr", titleplot = "External trade (growth rates)")

ggarrange(A,B,
          labels = c("(a)", "(b)"),
          hjust = -0.5, vjust = 1.5,
          ncol = 2, nrow = 1,
          widths = 2,  heights = 1)

```
---


# Effects on the production and the value added (2)
```{r ProdVA2, fig.height = 6, fig.width=10}
B <- curve_sc_plot(data_sector,"Y", growth.rate = FALSE,diff = TRUE,abs.diff = FALSE, title = "Production by sector (in difference from baseline)")

C <- curve_sc_plot(data_sector,"VA",diff=TRUE,growth.rate = FALSE,abs.diff = FALSE,title = " Added value by sector (in difference from baseline)")

ggarrange(B,C,
          labels = c("(a)", "(b)"),
          hjust = -0.5, vjust = 1.5,
          ncol = 1, nrow = 2,
          widths = 2,  heights = 1)


```

---

# Energy and Emissions

Energy

Emissions

---


## Effects on energy prices
```{r demande en produits energetiques, fig.height = 6, fig.width = 10}

energy_price <- simpleplot(data_full,c("PQ_CGAS", "PQ_CCOI"), c("Gas prices","Crude oil prices"), startyear, endyear, titleplot = " Shock on gas and oil prices (in difference from baseline)")
energy_price_bis <- simpleplot(data_full,c("PQ_CGAS", "PQ_CCOI"), c("Gas prices","Crude oil prices"), startyear, endyear, titleplot = " Shock on gas and oil prices (levels)",transformation = "level", unit=1)

energy_demand <- simpleplot(data_full,c("Q_CGAS", "Q_CCOI"), c("Gas","Crude oil"), startyear, endyear, titleplot = " Demand for gas and oil (in difference from baseline)")
energy_demand_bis <- simpleplot(data_full,c("Q_CGAS", "Q_CCOI"), c("Gas","Crude oil"), startyear, endyear, titleplot = " Demand on gas and oil (levels)",transformation = "level", unit=1)

ggarrange(energy_price,energy_price_bis,energy_demand,energy_demand_bis,
          labels = c("(a)", "(b)",'(c)',"(d)"),
          hjust = -0.5, vjust = 1.5,
          ncol = 2, nrow = 2,
          widths = 2,  heights = 1)

```

---


# Sectoral results

In contribution to total deviation (1)

For each sector

Economy composition

---

## In contribution to total deviation (1)
```{r Prod 1, fig.height = 6, fig.width=10}

data_plot <- contrib.sub(data_sector,var1 =  "Y",
                         group_type = "sector", scenar = c("baseline", scenario_name))

g1 <- contrib.sub.plot(data_plot,template = "ofce", startyear = 2020, endyear = 2050, line_tot =  TRUE,
                       titleplot = "Total production and sectorial decomposition  (in difference from baseline)")

data_plot <- contrib.sub(data_sector, var1 =  "VA",
                         group_type = "sector", scenar = c("baseline", scenario_name))

g2 <- contrib.sub.plot(data_plot, template = "ofce", startyear = 2020, endyear = 2050, line_tot =  TRUE,
                       titleplot = "Total Value Added and sectorial decomposition  (in difference from baseline)")

ggarrange(g1, g2,
          hjust = -0.5, vjust = 1.5,
          ncol = 1, nrow = 2,
          widths = 1,  heights = 2)

```

---

## In contribution to total deviation (2)
```{r VA 1, fig.height = 6, fig.width=10}

data_plot <- contrib.sub(data_sector, var1 =  "I",
                         group_type = "sector", scenar = c("baseline", scenario_name))

g1 <- contrib.sub.plot(data_plot, template = "ofce", startyear = 2020, endyear = 2050, line_tot =  TRUE,
                       titleplot = "Total Value Added and sectorial decomposition  (in difference from baseline)")

data_plot <- contrib.sub(data_sector,var1 =  "F_L",
                         group_type = "sector", scenar = c("baseline", scenario_name))

g2 <- contrib.sub.plot(data_plot, template = "ofce", startyear = 2020, endyear = 2050, line_tot =  TRUE,
                       titleplot = "Total Labor  (in difference from baseline)")

ggarrange(g1, g2,
          hjust = -0.5, vjust = 1.5,
          ncol = 1, nrow = 2,
          widths = 1,  heights = 2)

```

---

## Mettre des geom_bat plot par secteur
```{r sec bar, fig.height = 3, fig.width=7}

```

---

## treemap de l'économie
```{r treemap , fig.height = 3, fig.width=7}

```

---
